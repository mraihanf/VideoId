<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" th:href="@{/css/styles.css}" />
  <meta name="theme-color" content="#459d75">
  <link rel="manifest" th:href="@{/manifest.json}" />
  <link rel="shortcut icon" sizes="16x16" th:href="@{/images/BTV.ico}" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.18/dist/sweetalert2.min.css"
    integrity="sha256-7jUS+MWeqkFdmW9ozkZ7mPagz+QmMbsBlt+Q3MsE+FU=" crossorigin="anonymous">
  <!-- bootstrap -->
  <link th:href="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css}" rel="stylesheet"
    integrity="sha256-djO3wMl9GeaC/u6K+ic4Uj/LKhRUSlUFcsruzS7v5ms=" crossorigin="anonymous"
    referrerpolicy="no-referrer">
  <!-- font-awesome -->
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css}"
    integrity="sha384-iw3OoTErCYJJB9mCa8LNS2hbsQ7M3C0EpIsO/H5+EGAkPGc6rk+V8i04oW/K5xq0" crossorigin="anonymous">
  <!-- dataTable -->
  <link rel="stylesheet" th:href="@{https://cdn.datatables.net/1.13.5/css/dataTables.bootstrap5.min.css}"
    integrity="sha256-4W/j2Pv3N5VfbVDhzI8SKzHFHBfaOdZ2CZ1lXfxNofU=" crossorigin="anonymous"
    referrerpolicy="no-referrer">
  <title>VideoID B-Universe</title>
</head>


<body>
  <div class="container">
    <img style="width: 300px; display: block; margin: 5% auto 0px;" th:src="@{/images/B_UNIVERSE_LOGO_COLOR.png}">
    <h3 class="text-center" style="margin-top: -2rem; margin-bottom: 2rem;">Video ID</h3>
    <div class="row">
      <div class="col-2">
        <select type="text" id="format" class="form-control">
          <option value="" selected disabled>--FORMAT--</option>
          <option value="BA">Program BTV</option>
          <option value="TV">TVC/Filler</option>
          <option value="TR">TVC Rokok</option>
          <option value="PB">Promo</option>
          <option value="BU">Bumper</option>
          <option value="SI">Super Inpose</option>
          <option value="AI">Animated Inpose</option>
          <option value="RT">Runing text</option>
          <option value="SF">Squise Frame</option>
          <option value="LT">Lower Thirtd</option>
          <option value="VP">Virus</option>
          <option value="ST">Station ID</option>
        </select>
      </div>
      <div class="col-8">
        <input type="text" id="judul" class="form-control" required="true" placeholder="Judul" required/>
        <small class="form-text text-muted">Ex. NIVEAMAN CUCIMUKA 15SEC (namaprogram versi/judul
          durasi/episode)</small>

      </div>
      <div class="col-2">
        <a type="submit" class="btn btn-success btn-sm" style="width: 100%; color: white;" id="generated"><i
            class="fa-solid fa-arrows-rotate"></i></a>
      </div>
    </div>
    <div class="input-group" style="justify-content: center; justify-items: center; width: 100%; height: 5rem;">
      <h1 class="text-center mt-3" id="hasilnya"></h1>
      <button class="btncopy btn-primary mt-3" id="btncopy"
        style="border-radius: 5px; max-width: 2rem; max-height: 2rem; display: none;" data-clipboard-target="#hasilnya">
        <i class="fa-solid fa-copy"></i>
      </button>
    </div>

    <div class="row">
      <div class="col-10">
        <input type="text" id="cari" class="form-control" placeholder="Search" />
      </div>
      <div class="col-2">
        <select type="text" id="formatfilter" class="form-control">
          <option value="" selected disabled>--Filter by--</option>
          <option value="3">Program BTV</option>
          <option value="4">TVC/Filler</option>
          <option value="5">TVC Rokok</option>
          <option value="6">Promo</option>
          <option value="7">Bumper</option>
          <option value="8">Super Inpose</option>
          <option value="9">Animated Inpose</option>
          <option value="10">Runing text</option>
          <option value="11">Squise Frame</option>
          <option value="12">Lower Thirtd</option>
          <option value="13">Virus</option>
          <option value="14">Station ID</option>
        </select>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-bordered" id="tableLog" width="100%" cellspacing="0">
        <thead>
          <tr>
            <th>Video ID</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>
  </div>

</body>


</html>


<!---------------------------------------------------------------------------------------->

<script th:src="@{https://code.jquery.com/jquery-3.7.0.js}"
  integrity="sha256-JlqSTELeR4TLqP0OG9dxM7yDPqX1ox/HfgiSLBj8+kM=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script th:src="@{https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js}"
  integrity="sha256-WgfGn5Bh6xLjmgMTWKT1Z/MKACrWGCY5rIT9G9ovbmU=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js}"
  integrity="sha256-XDbijJp72GS2c+Ij234ZNJIyJ1Nv+9+HH1i28JuayMk=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.18/dist/sweetalert2.all.min.js"
  integrity="sha256-eYINpiFTsm812/hOBxFCGaSZzPvHBZZFYSe5ZWLgYzo=" crossorigin="anonymous"></script>
<script type="text/javascript" th:src="@{https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.0/axios.min.js}"
  integrity="sha256-xJNTehIpC6/bk41FMzIkPAjeo8cYvnGnxbv/YgAM1og=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script type="text/javascript" th:src="@{https://cdn.datatables.net/1.13.5/js/jquery.dataTables.min.js}"
  integrity="sha256-SiAZnUXHs7kYBGG6qPk6OD4EOKySGou87ww6tcmGwcM=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script th:src="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js}"
  integrity="sha384-Y7LSKwoY+C2iyfu/oupNnkGEN3EgA6skmJeVg5AyQk7ttcjX0XsLREmmuJW/SdbU" crossorigin="anonymous"></script>
<script type="text/javascript" th:src="@{https://cdn.datatables.net/1.13.5/js/dataTables.bootstrap5.min.js}"
  integrity="sha256-u2kP0BrkAUxorzBPuW9nh3TKCtaXXSD3VY6/gxvUJig=" crossorigin="anonymous"
  referrerpolicy="no-referrer"></script>
<script type="text/javascript" th:src="@{https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js}"
  integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>
<script th:inline="javascript">
  /*<![CDATA[*/
  $(document).ready(function () {
    today = mm + '/' + dd + '/' + yyyy;
    showtableVideoID();
    new ClipboardJS('.btncopy');
  })
  var today = new Date();
  var dd = String(today.getDate()).padStart(2, '0');
  var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
  var yyyy = String(today.getFullYear());
  var yy = yyyy.substring(2, 4);

  $("#cari").keyup(function () {
    tableVideoID.ajax.reload();
    });

  $("#formatfilter").change(function(){
    var opsi = $(this).val();
    tableVideoID.ajax.reload();
  })

  $("#generated").on("click", function () {

    var format = $("#format option:selected").val();
    var hasil1 = format + yy;
    // console.log(hasil1);

    var hasil2 = $("#judul").val().replaceAll(" ", "_");
    // var hasil2 = program[0] + "_" + program[1] + "_" + program[2];
    // console.log(hasil2);

    $.ajax({
      method: 'post',
      url: `/In?hasil1=${hasil1}&hasil2=${hasil2.toUpperCase()}&tahun=${yyyy}`,
      success: function (data, status, jqXHR) {
        // console.log(`${data.hasil}`);
        document.getElementById('hasilnya').innerHTML = `${data.hasil}`;
        document.getElementById('btncopy').style.display = 'block';
        tableVideoID.ajax.reload();
      }
    })

  })

  var tableVideoID;
  function showtableVideoID() {
    tableVideoID = $("#tableLog").DataTable({
      dom: "<'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>>\n        <'table-responsive'tr>\n        <'row align-items-center'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7 d-flex justify-content-end'p>>",
      language: {
        zeroRecords: "Data Tidak Ada",
        paginate: {
          previous: '<i class="fa fa-lg fa-angle-left"></i>',
          next: '<i class="fa fa-lg fa-angle-right"></i>',
        },
      },
      searching: false,
      stateSave: false,
      serverSide: true,
      processing: true,
      ordering: false,
      "bDestroy": true,
      "bLengthChange": false,
      "bInfo": false,
      // "bPaginate": false,
      lengthMenu: [5, 10],
      ajax: function (data, callback, settings) {
        var page = Math.ceil(
          settings._iDisplayStart / settings._iDisplayLength
        );
        var url = `/findvideo?start=${page}&length=${data.length}&sort=${$("#formatfilter option:selected").val()}&search=${$("#cari").val()}`;
        $.get(url, function (response) {
          var out = [];
          response.data.content.forEach(function (logC, i) {
            out.push([
              logC.hasil,
            ]);
          });
          callback({
            recordsTotal: response.data.totalElements,
            recordsFiltered: response.data.totalElements,
            data: out,
          });
        });
      },
      deferRender: true,
    });
  }

  /*]]>*/
</script>